[
  {
    "path": "posts/2021-08-29-Hands-on-exercise-2/",
    "title": "Hands-on Exercise 2",
    "description": "In this hands-on exercise, I will learn how to handle geospatial data in R by using sf package.",
    "author": [
      {
        "name": "Niharika Avula",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-09-01",
    "categories": [],
    "contents": "\r\n\r\n\r\npackages <- c('sf', 'tidyverse')\r\nfor (p in packages){\r\n  if (!require(p, character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p, character.only = T)\r\n  }\r\n\r\n\r\n\r\nImporting Geospatial Data\r\nImporting polygon feature data in shapefile format\r\nThe code chunk below uses st_read() function of sf package to import MP14_SUBZONE_WEB_PL shapefile into R as a polygon feature data frame.\r\n\r\n\r\nmpsz = st_read(dsn =  \"Data/Geospatial\", \r\n                  layer = \"MP14_SUBZONE_WEB_PL\")\r\n\r\n\r\nReading layer `MP14_SUBZONE_WEB_PL' from data source \r\n  `C:\\Niharika-avula\\IS415_blog\\_posts\\2021-08-29-Hands-on-exercise-2\\Data\\Geospatial' \r\n  using driver `ESRI Shapefile'\r\nSimple feature collection with 323 features and 15 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\r\nProjected CRS: SVY21\r\n\r\nImporting polyline feature data in shapefile form\r\nThe code chunk below uses st_read() function of sf package to import CyclingPath shapefile into R as line feature data frame.\r\n\r\n\r\ncyclingpath = st_read(dsn = \"data/geospatial\", \r\n                         layer = \"CyclingPath\")\r\n\r\n\r\nReading layer `CyclingPath' from data source \r\n  `C:\\Niharika-avula\\IS415_blog\\_posts\\2021-08-29-Hands-on-exercise-2\\Data\\Geospatial' \r\n  using driver `ESRI Shapefile'\r\nSimple feature collection with 3336 features and 2 fields\r\nGeometry type: MULTILINESTRING\r\nDimension:     XY\r\nBounding box:  xmin: 12831.45 ymin: 28347.98 xmax: 42799.89 ymax: 48948.15\r\nProjected CRS: SVY21\r\n\r\nImporting GIS data in kml format\r\nThe code chunk below will be used to import the kml into R. Notice that in the code chunk below, the complete path and the kml file extension were provided\r\n\r\n\r\npreschool = st_read(\"data/geospatial/pre-schools-location-kml.kml\")\r\n\r\n\r\nReading layer `PRESCHOOLS_LOCATION' from data source \r\n  `C:\\Niharika-avula\\IS415_blog\\_posts\\2021-08-29-Hands-on-exercise-2\\Data\\Geospatial\\pre-schools-location-kml.kml' \r\n  using driver `KML'\r\nSimple feature collection with 1925 features and 2 fields\r\nGeometry type: POINT\r\nDimension:     XYZ\r\nBounding box:  xmin: 103.6824 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\r\nz_range:       zmin: 0 zmax: 0\r\nGeodetic CRS:  WGS 84\r\n\r\nChecking the Content of a Simple Feature Data Frame\r\nWorking with st_geometry()\r\n\r\n\r\nst_geometry(mpsz)\r\n\r\n\r\nGeometry set for 323 features \r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\r\nProjected CRS: SVY21\r\nFirst 5 geometries:\r\n\r\nWorking with glimpse()\r\nglimpse() report reveals the data type of each fields.\r\n\r\n\r\nglimpse(mpsz)\r\n\r\n\r\nRows: 323\r\nColumns: 16\r\n$ OBJECTID   <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15~\r\n$ SUBZONE_NO <int> 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1,~\r\n$ SUBZONE_N  <chr> \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HEN~\r\n$ SUBZONE_C  <chr> \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\",~\r\n$ CA_IND     <chr> \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\",~\r\n$ PLN_AREA_N <chr> \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUK~\r\n$ PLN_AREA_C <chr> \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"~\r\n$ REGION_N   <chr> \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGI~\r\n$ REGION_C   <chr> \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"~\r\n$ INC_CRC    <chr> \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF0~\r\n$ FMEL_UPD_D <date> 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, ~\r\n$ X_ADDR     <dbl> 31595.84, 28679.06, 29654.96, 26782.83, 26201.96,~\r\n$ Y_ADDR     <dbl> 29220.19, 29782.05, 29974.66, 29933.77, 30005.70,~\r\n$ SHAPE_Leng <dbl> 5267.381, 3506.107, 1740.926, 3313.625, 2825.594,~\r\n$ SHAPE_Area <dbl> 1630379.3, 559816.2, 160807.5, 595428.9, 387429.4~\r\n$ geometry   <MULTIPOLYGON [m]> MULTIPOLYGON (((31495.56 30..., MULT~\r\n\r\nWorking with head()\r\n\r\n\r\nhead(mpsz, n=5) \r\n\r\n\r\nSimple feature collection with 5 features and 15 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 25867.68 ymin: 28369.47 xmax: 32362.39 ymax: 30435.54\r\nProjected CRS: SVY21\r\n  OBJECTID SUBZONE_NO      SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\r\n1        1          1   MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\r\n2        2          1   PEARL'S HILL    OTSZ01      Y          OUTRAM\r\n3        3          3      BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\r\n4        4          8 HENDERSON HILL    BMSZ08      N     BUKIT MERAH\r\n5        5          3        REDHILL    BMSZ03      N     BUKIT MERAH\r\n  PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D\r\n1         MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05\r\n2         OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05\r\n3         SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05\r\n4         BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05\r\n5         BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05\r\n    X_ADDR   Y_ADDR SHAPE_Leng SHAPE_Area\r\n1 31595.84 29220.19   5267.381  1630379.3\r\n2 28679.06 29782.05   3506.107   559816.2\r\n3 29654.96 29974.66   1740.926   160807.5\r\n4 26782.83 29933.77   3313.625   595428.9\r\n5 26201.96 30005.70   2825.594   387429.4\r\n                        geometry\r\n1 MULTIPOLYGON (((31495.56 30...\r\n2 MULTIPOLYGON (((29092.28 30...\r\n3 MULTIPOLYGON (((29932.33 29...\r\n4 MULTIPOLYGON (((27131.28 30...\r\n5 MULTIPOLYGON (((26451.03 30...\r\n\r\nPlotting the Geospatial Data\r\n\r\n\r\nplot(mpsz)\r\n\r\n\r\n\r\n\r\n\r\n\r\nplot(st_geometry(mpsz))\r\n\r\n\r\n\r\n\r\n\r\n\r\nplot(mpsz[\"PLN_AREA_N\"])\r\n\r\n\r\n\r\n\r\nWorking with Projection\r\n\r\n\r\nst_crs(mpsz)\r\n\r\n\r\nCoordinate Reference System:\r\n  User input: SVY21 \r\n  wkt:\r\nPROJCRS[\"SVY21\",\r\n    BASEGEOGCRS[\"SVY21[WGS84]\",\r\n        DATUM[\"World Geodetic System 1984\",\r\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\r\n                LENGTHUNIT[\"metre\",1]],\r\n            ID[\"EPSG\",6326]],\r\n        PRIMEM[\"Greenwich\",0,\r\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\r\n    CONVERSION[\"unnamed\",\r\n        METHOD[\"Transverse Mercator\",\r\n            ID[\"EPSG\",9807]],\r\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\r\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\r\n            ID[\"EPSG\",8801]],\r\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\r\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\r\n            ID[\"EPSG\",8802]],\r\n        PARAMETER[\"Scale factor at natural origin\",1,\r\n            SCALEUNIT[\"unity\",1],\r\n            ID[\"EPSG\",8805]],\r\n        PARAMETER[\"False easting\",28001.642,\r\n            LENGTHUNIT[\"metre\",1],\r\n            ID[\"EPSG\",8806]],\r\n        PARAMETER[\"False northing\",38744.572,\r\n            LENGTHUNIT[\"metre\",1],\r\n            ID[\"EPSG\",8807]]],\r\n    CS[Cartesian,2],\r\n        AXIS[\"(E)\",east,\r\n            ORDER[1],\r\n            LENGTHUNIT[\"metre\",1,\r\n                ID[\"EPSG\",9001]]],\r\n        AXIS[\"(N)\",north,\r\n            ORDER[2],\r\n            LENGTHUNIT[\"metre\",1,\r\n                ID[\"EPSG\",9001]]]]\r\n\r\nAssigning EPSG code to a simple feature data frame\r\n\r\n\r\nmpsz3414 <- st_set_crs(mpsz, 3414)\r\n\r\n\r\n\r\n\r\n\r\nst_crs(mpsz)\r\n\r\n\r\nCoordinate Reference System:\r\n  User input: SVY21 \r\n  wkt:\r\nPROJCRS[\"SVY21\",\r\n    BASEGEOGCRS[\"SVY21[WGS84]\",\r\n        DATUM[\"World Geodetic System 1984\",\r\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\r\n                LENGTHUNIT[\"metre\",1]],\r\n            ID[\"EPSG\",6326]],\r\n        PRIMEM[\"Greenwich\",0,\r\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\r\n    CONVERSION[\"unnamed\",\r\n        METHOD[\"Transverse Mercator\",\r\n            ID[\"EPSG\",9807]],\r\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\r\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\r\n            ID[\"EPSG\",8801]],\r\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\r\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\r\n            ID[\"EPSG\",8802]],\r\n        PARAMETER[\"Scale factor at natural origin\",1,\r\n            SCALEUNIT[\"unity\",1],\r\n            ID[\"EPSG\",8805]],\r\n        PARAMETER[\"False easting\",28001.642,\r\n            LENGTHUNIT[\"metre\",1],\r\n            ID[\"EPSG\",8806]],\r\n        PARAMETER[\"False northing\",38744.572,\r\n            LENGTHUNIT[\"metre\",1],\r\n            ID[\"EPSG\",8807]]],\r\n    CS[Cartesian,2],\r\n        AXIS[\"(E)\",east,\r\n            ORDER[1],\r\n            LENGTHUNIT[\"metre\",1,\r\n                ID[\"EPSG\",9001]]],\r\n        AXIS[\"(N)\",north,\r\n            ORDER[2],\r\n            LENGTHUNIT[\"metre\",1,\r\n                ID[\"EPSG\",9001]]]]\r\n\r\nTransforming the projection of preschool from wgs84 to svy21\r\n\r\n\r\npreschool3414 <- st_transform(preschool, \r\n                              crs = 3414)\r\n\r\n\r\n\r\n\r\n\r\npreschool3414\r\n\r\n\r\nSimple feature collection with 1925 features and 2 fields\r\nGeometry type: POINT\r\nDimension:     XYZ\r\nBounding box:  xmin: 11203.01 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88\r\nz_range:       zmin: 0 zmax: 0\r\nProjected CRS: SVY21 / Singapore TM\r\nFirst 10 features:\r\n     Name\r\n1   kml_1\r\n2   kml_2\r\n3   kml_3\r\n4   kml_4\r\n5   kml_5\r\n6   kml_6\r\n7   kml_7\r\n8   kml_8\r\n9   kml_9\r\n10 kml_10\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Description\r\n1             <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BRILLIANT TOTS PTE. LTD.<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT9334<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>610, JURONG WEST STREET 65, #01 - 534, S 640610<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>640610<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>0523C7904478A63D<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n2             <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BUBBLESLAND PLAYHOUSE PTE LTD<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT7680<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>238, COMPASSVALE WALK, #01 - 542, S 540238<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>540238<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>18BED05A501AA168<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n3       <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BUCKET HOUSE PRESCHOOL<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT9527<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>39, WOODLANDS CLOSE, #01 - 62, MEGA@WOODLANDS, S 737856<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>737856<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>C88B9AC31EE71BF6<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n4            <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BUMBLE BEE CHILD CARE CENTRE<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT3150<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>369, WOODLANDS AVENUE 1, #01 - 853, S 730369<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>730369<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>64AB8FACA8F60129<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n5               <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BUSY BEES SINGAPORE PTE LTD<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT9117<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>327B, ANCHORVALE ROAD, #01 - 322, S 542327<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>542327<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>E1B55AC65B9059E8<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n6                  <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BUSY BEES SINGAPORE PTE LTD<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT9066<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>211A, PUNGGOL WALK, #01 - 623, S 821211<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>821211<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>3B5A4AF2696592AA<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n7       <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BUSY BEES SINGAPORE PTE LTD<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT9479<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>2, GAMBAS CRESCENT,  - 01-03, NORDCOM II, S 757044<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>757044<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>5F5452B568838620<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n8          <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BUSY BEES SINGAPORE PTE.LTD<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT9127<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>6, SERANGOON NORTH AVENUE 5, #02 - 01, S 554910<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>554910<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>3AD4173BBB057D89<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n9             <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>BUSY BEES SINGAPORE PTE.LTD.<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT9067<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>348A, YISHUN AVENUE 11, #01 - 557, S 761348<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>761348<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>F4D7A4BDA3CBB15F<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n10 <center><table><tr><th colspan='2' align='center'><em>Attributes<\/em><\/th><\/tr><tr bgcolor=\"#E3E3F3\"> <th>CENTRE_NAME<\/th> <td>CAELUM JUNIOR @ BENDEMEER PTE. LTD.<\/td> <\/tr><tr bgcolor=\"\"> <th>CENTRE_CODE<\/th> <td>PT9053<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>ADDRESS<\/th> <td>70, BENDEMEER ROAD, #02 - 01, LUZERNE, S 339940<\/td> <\/tr><tr bgcolor=\"\"> <th>POSTAL_CODE<\/th> <td>339940<\/td> <\/tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC<\/th> <td>D55FC7583E8CCBA7<\/td> <\/tr><tr bgcolor=\"\"> <th>FMEL_UPD_D<\/th> <td>20200812235534<\/td> <\/tr><\/table><\/center>\r\n                        geometry\r\n1  POINT Z (13258.34 35611.04 0)\r\n2  POINT Z (35272.09 41373.42 0)\r\n3  POINT Z (25050.54 46634.14 0)\r\n4  POINT Z (22892.48 46127.66 0)\r\n5  POINT Z (34155.79 41949.13 0)\r\n6   POINT Z (35414.54 42625.1 0)\r\n7  POINT Z (26046.98 47205.62 0)\r\n8  POINT Z (31980.09 39607.05 0)\r\n9  POINT Z (28879.22 45454.97 0)\r\n10 POINT Z (31250.89 33171.55 0)\r\n\r\nImporting and Converting An Aspatial Data\r\nImporting the Spatial data\r\n\r\n\r\nlistings <- read_csv(\"data/aspatial/listings.csv\")\r\n\r\n\r\n\r\n\r\n\r\nglimpse(listings) \r\n\r\n\r\nRows: 4,252\r\nColumns: 74\r\n$ id                                           <dbl> 50646, 71609, 7~\r\n$ listing_url                                  <chr> \"https://www.ai~\r\n$ scrape_id                                    <dbl> 2.021072e+13, 2~\r\n$ last_scraped                                 <date> 2021-07-19, 20~\r\n$ name                                         <chr> \"Pleasant Room ~\r\n$ description                                  <chr> \"Fully furnishe~\r\n$ neighborhood_overview                        <chr> \"The serenity &~\r\n$ picture_url                                  <chr> \"https://a0.mus~\r\n$ host_id                                      <dbl> 227796, 367042,~\r\n$ host_url                                     <chr> \"https://www.ai~\r\n$ host_name                                    <chr> \"Sujatha\", \"Bel~\r\n$ host_since                                   <date> 2010-09-08, 20~\r\n$ host_location                                <chr> \"Singapore, Sin~\r\n$ host_about                                   <chr> \"I am a working~\r\n$ host_response_time                           <chr> \"N/A\", \"within ~\r\n$ host_response_rate                           <chr> \"N/A\", \"100%\", ~\r\n$ host_acceptance_rate                         <chr> \"N/A\", \"N/A\", \"~\r\n$ host_is_superhost                            <lgl> FALSE, FALSE, F~\r\n$ host_thumbnail_url                           <chr> \"https://a0.mus~\r\n$ host_picture_url                             <chr> \"https://a0.mus~\r\n$ host_neighbourhood                           <chr> \"Bukit Timah\", ~\r\n$ host_listings_count                          <dbl> 1, 8, 8, 8, 50,~\r\n$ host_total_listings_count                    <dbl> 1, 8, 8, 8, 50,~\r\n$ host_verifications                           <chr> \"['email', 'pho~\r\n$ host_has_profile_pic                         <lgl> TRUE, TRUE, TRU~\r\n$ host_identity_verified                       <lgl> TRUE, TRUE, TRU~\r\n$ neighbourhood                                <chr> \"Singapore, Sin~\r\n$ neighbourhood_cleansed                       <chr> \"Bukit Timah\", ~\r\n$ neighbourhood_group_cleansed                 <chr> \"Central Region~\r\n$ latitude                                     <dbl> 1.33432, 1.3453~\r\n$ longitude                                    <dbl> 103.7852, 103.9~\r\n$ property_type                                <chr> \"Private room i~\r\n$ room_type                                    <chr> \"Private room\",~\r\n$ accommodates                                 <dbl> 2, 6, 3, 3, 1, ~\r\n$ bathrooms                                    <lgl> NA, NA, NA, NA,~\r\n$ bathrooms_text                               <chr> \"1 bath\", \"1 pr~\r\n$ bedrooms                                     <dbl> 1, 2, 1, 1, 1, ~\r\n$ beds                                         <dbl> 1, 3, 1, 2, 1, ~\r\n$ amenities                                    <chr> \"[\\\"Washer\\\", \\~\r\n$ price                                        <chr> \"$80.00\", \"$178~\r\n$ minimum_nights                               <dbl> 90, 90, 90, 90,~\r\n$ maximum_nights                               <dbl> 730, 1125, 1125~\r\n$ minimum_minimum_nights                       <dbl> 90, 90, 90, 90,~\r\n$ maximum_minimum_nights                       <dbl> 90, 90, 90, 90,~\r\n$ minimum_maximum_nights                       <dbl> 730, 1125, 1125~\r\n$ maximum_maximum_nights                       <dbl> 730, 1125, 1125~\r\n$ minimum_nights_avg_ntm                       <dbl> 90, 90, 90, 90,~\r\n$ maximum_nights_avg_ntm                       <dbl> 730, 1125, 1125~\r\n$ calendar_updated                             <lgl> NA, NA, NA, NA,~\r\n$ has_availability                             <lgl> TRUE, TRUE, TRU~\r\n$ availability_30                              <dbl> 30, 30, 30, 30,~\r\n$ availability_60                              <dbl> 60, 60, 60, 60,~\r\n$ availability_90                              <dbl> 90, 90, 90, 90,~\r\n$ availability_365                             <dbl> 365, 365, 365, ~\r\n$ calendar_last_scraped                        <date> 2021-07-19, 20~\r\n$ number_of_reviews                            <dbl> 18, 20, 24, 48,~\r\n$ number_of_reviews_ltm                        <dbl> 0, 0, 0, 0, 0, ~\r\n$ number_of_reviews_l30d                       <dbl> 0, 0, 0, 0, 0, ~\r\n$ first_review                                 <date> 2014-10-14, 20~\r\n$ last_review                                  <date> 2014-07-08, 20~\r\n$ review_scores_rating                         <dbl> 4.56, 4.44, 4.1~\r\n$ review_scores_accuracy                       <dbl> 4.72, 4.37, 4.2~\r\n$ review_scores_cleanliness                    <dbl> 4.78, 4.00, 4.0~\r\n$ review_scores_checkin                        <dbl> 4.78, 4.63, 4.4~\r\n$ review_scores_communication                  <dbl> 4.94, 4.78, 4.4~\r\n$ review_scores_location                       <dbl> 4.72, 4.26, 4.1~\r\n$ review_scores_value                          <dbl> 4.50, 4.32, 4.0~\r\n$ license                                      <chr> NA, NA, NA, NA,~\r\n$ instant_bookable                             <lgl> FALSE, TRUE, TR~\r\n$ calculated_host_listings_count               <dbl> 1, 4, 4, 4, 50,~\r\n$ calculated_host_listings_count_entire_homes  <dbl> 0, 0, 0, 0, 1, ~\r\n$ calculated_host_listings_count_private_rooms <dbl> 1, 4, 4, 4, 49,~\r\n$ calculated_host_listings_count_shared_rooms  <dbl> 0, 0, 0, 0, 0, ~\r\n$ reviews_per_month                            <dbl> 0.22, 0.28, 0.3~\r\n\r\nCreating a simple feature data frame from an aspatial data frame\r\n\r\n\r\nlistings_sf <- st_as_sf(listings, \r\n                       coords = c(\"longitude\", \"latitude\"),\r\n                       crs=4326) %>%\r\n  st_transform(crs = 3414)\r\n\r\n\r\n\r\n\r\n\r\nglimpse(listings) \r\n\r\n\r\nRows: 4,252\r\nColumns: 74\r\n$ id                                           <dbl> 50646, 71609, 7~\r\n$ listing_url                                  <chr> \"https://www.ai~\r\n$ scrape_id                                    <dbl> 2.021072e+13, 2~\r\n$ last_scraped                                 <date> 2021-07-19, 20~\r\n$ name                                         <chr> \"Pleasant Room ~\r\n$ description                                  <chr> \"Fully furnishe~\r\n$ neighborhood_overview                        <chr> \"The serenity &~\r\n$ picture_url                                  <chr> \"https://a0.mus~\r\n$ host_id                                      <dbl> 227796, 367042,~\r\n$ host_url                                     <chr> \"https://www.ai~\r\n$ host_name                                    <chr> \"Sujatha\", \"Bel~\r\n$ host_since                                   <date> 2010-09-08, 20~\r\n$ host_location                                <chr> \"Singapore, Sin~\r\n$ host_about                                   <chr> \"I am a working~\r\n$ host_response_time                           <chr> \"N/A\", \"within ~\r\n$ host_response_rate                           <chr> \"N/A\", \"100%\", ~\r\n$ host_acceptance_rate                         <chr> \"N/A\", \"N/A\", \"~\r\n$ host_is_superhost                            <lgl> FALSE, FALSE, F~\r\n$ host_thumbnail_url                           <chr> \"https://a0.mus~\r\n$ host_picture_url                             <chr> \"https://a0.mus~\r\n$ host_neighbourhood                           <chr> \"Bukit Timah\", ~\r\n$ host_listings_count                          <dbl> 1, 8, 8, 8, 50,~\r\n$ host_total_listings_count                    <dbl> 1, 8, 8, 8, 50,~\r\n$ host_verifications                           <chr> \"['email', 'pho~\r\n$ host_has_profile_pic                         <lgl> TRUE, TRUE, TRU~\r\n$ host_identity_verified                       <lgl> TRUE, TRUE, TRU~\r\n$ neighbourhood                                <chr> \"Singapore, Sin~\r\n$ neighbourhood_cleansed                       <chr> \"Bukit Timah\", ~\r\n$ neighbourhood_group_cleansed                 <chr> \"Central Region~\r\n$ latitude                                     <dbl> 1.33432, 1.3453~\r\n$ longitude                                    <dbl> 103.7852, 103.9~\r\n$ property_type                                <chr> \"Private room i~\r\n$ room_type                                    <chr> \"Private room\",~\r\n$ accommodates                                 <dbl> 2, 6, 3, 3, 1, ~\r\n$ bathrooms                                    <lgl> NA, NA, NA, NA,~\r\n$ bathrooms_text                               <chr> \"1 bath\", \"1 pr~\r\n$ bedrooms                                     <dbl> 1, 2, 1, 1, 1, ~\r\n$ beds                                         <dbl> 1, 3, 1, 2, 1, ~\r\n$ amenities                                    <chr> \"[\\\"Washer\\\", \\~\r\n$ price                                        <chr> \"$80.00\", \"$178~\r\n$ minimum_nights                               <dbl> 90, 90, 90, 90,~\r\n$ maximum_nights                               <dbl> 730, 1125, 1125~\r\n$ minimum_minimum_nights                       <dbl> 90, 90, 90, 90,~\r\n$ maximum_minimum_nights                       <dbl> 90, 90, 90, 90,~\r\n$ minimum_maximum_nights                       <dbl> 730, 1125, 1125~\r\n$ maximum_maximum_nights                       <dbl> 730, 1125, 1125~\r\n$ minimum_nights_avg_ntm                       <dbl> 90, 90, 90, 90,~\r\n$ maximum_nights_avg_ntm                       <dbl> 730, 1125, 1125~\r\n$ calendar_updated                             <lgl> NA, NA, NA, NA,~\r\n$ has_availability                             <lgl> TRUE, TRUE, TRU~\r\n$ availability_30                              <dbl> 30, 30, 30, 30,~\r\n$ availability_60                              <dbl> 60, 60, 60, 60,~\r\n$ availability_90                              <dbl> 90, 90, 90, 90,~\r\n$ availability_365                             <dbl> 365, 365, 365, ~\r\n$ calendar_last_scraped                        <date> 2021-07-19, 20~\r\n$ number_of_reviews                            <dbl> 18, 20, 24, 48,~\r\n$ number_of_reviews_ltm                        <dbl> 0, 0, 0, 0, 0, ~\r\n$ number_of_reviews_l30d                       <dbl> 0, 0, 0, 0, 0, ~\r\n$ first_review                                 <date> 2014-10-14, 20~\r\n$ last_review                                  <date> 2014-07-08, 20~\r\n$ review_scores_rating                         <dbl> 4.56, 4.44, 4.1~\r\n$ review_scores_accuracy                       <dbl> 4.72, 4.37, 4.2~\r\n$ review_scores_cleanliness                    <dbl> 4.78, 4.00, 4.0~\r\n$ review_scores_checkin                        <dbl> 4.78, 4.63, 4.4~\r\n$ review_scores_communication                  <dbl> 4.94, 4.78, 4.4~\r\n$ review_scores_location                       <dbl> 4.72, 4.26, 4.1~\r\n$ review_scores_value                          <dbl> 4.50, 4.32, 4.0~\r\n$ license                                      <chr> NA, NA, NA, NA,~\r\n$ instant_bookable                             <lgl> FALSE, TRUE, TR~\r\n$ calculated_host_listings_count               <dbl> 1, 4, 4, 4, 50,~\r\n$ calculated_host_listings_count_entire_homes  <dbl> 0, 0, 0, 0, 1, ~\r\n$ calculated_host_listings_count_private_rooms <dbl> 1, 4, 4, 4, 49,~\r\n$ calculated_host_listings_count_shared_rooms  <dbl> 0, 0, 0, 0, 0, ~\r\n$ reviews_per_month                            <dbl> 0.22, 0.28, 0.3~\r\n\r\nGeoprocessing with sf package\r\nBuffering\r\nThe scenario: The authority is planning to upgrade the exiting cycling path. To do so, they need to acquire 5 metres of reserved land on the both sides of the current cycling path. You are tasked to determine the extend of the land need to be acquired and their total area.\r\n\r\n\r\nbuffer_cycling <- st_buffer(cyclingpath, \r\n                               dist=5, nQuadSegs = 30) \r\n\r\n\r\n\r\n\r\n\r\nbuffer_cycling$AREA <- st_area(buffer_cycling)\r\nsum(buffer_cycling$AREA)\r\n\r\n\r\n1642750 [m^2]\r\n\r\nPoint-in-polygon count\r\nThe scenario: A pre-school service group want to find out the numbers of pre-schools in each Planning Subzone.\r\nThe code chunk below performs two operations at one go. Firstly, identify pre-schools located inside each Planning Subzone by using st_intersects(). Next, length() of Base R is used to calculate numbers of pre-schools that fall inside each planning subzone.\r\n\r\n\r\nmpsz3414$`PreSch Count`<- lengths(st_intersects(mpsz3414, preschool3414))\r\n\r\n\r\n\r\n\r\n\r\nsummary(mpsz3414$`PreSch Count`)\r\n\r\n\r\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \r\n   0.00    0.00    3.00    5.96    9.00   58.00 \r\n\r\nTo list the planning subzone with the most number of pre-school, the top_n() of dplyr package is used as shown in the code chunk below.\r\n\r\n\r\ntop_n(mpsz3414, 1, `PreSch Count`)\r\n\r\n\r\nSimple feature collection with 1 feature and 16 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\r\nProjected CRS: SVY21 / Singapore TM\r\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N\r\n1      189          2 TAMPINES EAST    TMSZ02      N   TAMPINES\r\n  PLN_AREA_C    REGION_N REGION_C          INC_CRC FMEL_UPD_D\r\n1         TM EAST REGION       ER 21658EAAF84F4D8D 2014-12-05\r\n    X_ADDR   Y_ADDR SHAPE_Leng SHAPE_Area\r\n1 41122.55 37392.39   10180.62    4339824\r\n                        geometry PreSch Count\r\n1 MULTIPOLYGON (((42196.76 38...           58\r\n\r\nCalculate the density of pre-school by planning subzone.\r\n\r\n\r\nmpsz3414$Area <- mpsz3414 %>%\r\n  st_area()\r\n\r\n\r\n\r\nNext, mutate() of dplyr package is used to compute the density by using the code chunk below.\r\n\r\n\r\nmpsz3414 <- mpsz3414 %>%\r\n  mutate(`PreSch Density` = `PreSch Count`/Area * 1000000)\r\n\r\n\r\n\r\nExplorotary Data Analysis (EDA)\r\nIn this section, you will learn how to use appropriate ggplot2 functions to create functional and yet truthful statistical graphs for EDA purposes.\r\nHistogram\r\n\r\n\r\nhist(mpsz3414$`PreSch Density`)\r\n\r\n\r\n\r\n\r\n\r\n\r\nggplot(data=mpsz3414, \r\n       aes(x= as.numeric(`PreSch Density`)))+\r\n  geom_histogram(bins=20, \r\n                 color=\"black\", \r\n                 fill=\"light blue\") +\r\n  labs(title = \"Are pre-school even distributed in Singapore?\",\r\n       subtitle= \"There are many planning sub-zones with a single pre-school, on the other hand, \\nthere are two planning sub-zones with at least 20 pre-schools\",\r\n      x = \"Pre-school density (per km sq)\",\r\n      y = \"Frequency\")\r\n\r\n\r\n\r\n\r\nScatter Plot\r\nplotting a scatterplot showing the relationship between Pre-school Density and Pre-school Count\r\n\r\n\r\nggplot(data = mpsz3414, \r\n       aes(y = `PreSch Count`,\r\n           x = as.numeric(`PreSch Density`)))+\r\n  geom_point(color=\"black\", \r\n                 fill=\"light blue\") +\r\n  xlim(0, 40) +\r\n  ylim(0, 40) +\r\n  labs(title = \"\",\r\n       x = \"Pre-school Density (per km sq)\",\r\n       y = \"Pre-school Count\")\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-08-29-Hands-on-exercise-2/distill-preview.png",
    "last_modified": "2021-09-01T09:21:11+08:00",
    "input_file": "hands-on-exercise-2.knit.md"
  },
  {
    "path": "posts/2021-08-31-hands-on-exercise-3/",
    "title": "Hands-on Exercise 3",
    "description": "In this hands-on exercise, I will learn how to plot functional and truthful choropleth maps by using an R package called tmap package.",
    "author": [
      {
        "name": "Niharika Avula",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-08-31",
    "categories": [],
    "contents": "\r\nImporting the required Packages\r\n\r\n\r\npackages <- c('sf', 'tmap', 'tidyverse')\r\nfor (p in packages){\r\n  if (!require(p, character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p, character.only = T)\r\n  }\r\n\r\n\r\n\r\nThe Data\r\nTwo data set will be used to create the choropleth map. They are:\r\nMaster Plan 2014 Subzone Boundary (Web) (i.e. MP14_SUBZONE_WEB_PL) in ESRI shapefile format. It consists of the geographical boundary of Singapore at the planning subzone level. The data is based on URA Master Plan 2014.\r\nSingapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2011-2020 in csv format (i.e. respopagesextod2011to2020.csv). This is an aspatial data fie. Although it does not contain any coordinates values, but it’s PA and SZ fields can be used as unique identifiers to geocode to MP14_SUBZONE_WEB_PL shapefile.\r\nImporting Data\r\nImporting Geospatial Data\r\nThe code chunk below uses the st_read() function of sf package to import\r\n\r\n\r\nmpsz <- st_read(dsn = \"Data/Geospatial\",\r\n                layer = \"MP14_SUBZONE_WEB_PL\")\r\n\r\n\r\nReading layer `MP14_SUBZONE_WEB_PL' from data source \r\n  `C:\\Niharika-avula\\IS415_blog\\_posts\\2021-08-31-hands-on-exercise-3\\Data\\Geospatial' \r\n  using driver `ESRI Shapefile'\r\nSimple feature collection with 323 features and 15 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\r\nProjected CRS: SVY21\r\n\r\n\r\n\r\nmpsz\r\n\r\n\r\nSimple feature collection with 323 features and 15 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\r\nProjected CRS: SVY21\r\nFirst 10 features:\r\n   OBJECTID SUBZONE_NO       SUBZONE_N SUBZONE_C CA_IND\r\n1         1          1    MARINA SOUTH    MSSZ01      Y\r\n2         2          1    PEARL'S HILL    OTSZ01      Y\r\n3         3          3       BOAT QUAY    SRSZ03      Y\r\n4         4          8  HENDERSON HILL    BMSZ08      N\r\n5         5          3         REDHILL    BMSZ03      N\r\n6         6          7  ALEXANDRA HILL    BMSZ07      N\r\n7         7          9   BUKIT HO SWEE    BMSZ09      N\r\n8         8          2     CLARKE QUAY    SRSZ02      Y\r\n9         9         13 PASIR PANJANG 1    QTSZ13      N\r\n10       10          7       QUEENSWAY    QTSZ07      N\r\n        PLN_AREA_N PLN_AREA_C       REGION_N REGION_C\r\n1     MARINA SOUTH         MS CENTRAL REGION       CR\r\n2           OUTRAM         OT CENTRAL REGION       CR\r\n3  SINGAPORE RIVER         SR CENTRAL REGION       CR\r\n4      BUKIT MERAH         BM CENTRAL REGION       CR\r\n5      BUKIT MERAH         BM CENTRAL REGION       CR\r\n6      BUKIT MERAH         BM CENTRAL REGION       CR\r\n7      BUKIT MERAH         BM CENTRAL REGION       CR\r\n8  SINGAPORE RIVER         SR CENTRAL REGION       CR\r\n9       QUEENSTOWN         QT CENTRAL REGION       CR\r\n10      QUEENSTOWN         QT CENTRAL REGION       CR\r\n            INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\r\n1  5ED7EB253F99252E 2014-12-05 31595.84 29220.19   5267.381\r\n2  8C7149B9EB32EEFC 2014-12-05 28679.06 29782.05   3506.107\r\n3  C35FEFF02B13E0E5 2014-12-05 29654.96 29974.66   1740.926\r\n4  3775D82C5DDBEFBD 2014-12-05 26782.83 29933.77   3313.625\r\n5  85D9ABEF0A40678F 2014-12-05 26201.96 30005.70   2825.594\r\n6  9D286521EF5E3B59 2014-12-05 25358.82 29991.38   4428.913\r\n7  7839A8577144EFE2 2014-12-05 27680.06 30230.86   3275.312\r\n8  48661DC0FBA09F7A 2014-12-05 29253.21 30222.86   2208.619\r\n9  1F721290C421BFAB 2014-12-05 22077.34 29893.78   6571.323\r\n10 3580D2AFFBEE914C 2014-12-05 24168.31 30104.18   3454.239\r\n   SHAPE_Area                       geometry\r\n1   1630379.3 MULTIPOLYGON (((31495.56 30...\r\n2    559816.2 MULTIPOLYGON (((29092.28 30...\r\n3    160807.5 MULTIPOLYGON (((29932.33 29...\r\n4    595428.9 MULTIPOLYGON (((27131.28 30...\r\n5    387429.4 MULTIPOLYGON (((26451.03 30...\r\n6   1030378.8 MULTIPOLYGON (((25899.7 297...\r\n7    551732.0 MULTIPOLYGON (((27746.95 30...\r\n8    290184.7 MULTIPOLYGON (((29351.26 29...\r\n9   1084792.3 MULTIPOLYGON (((20996.49 30...\r\n10   631644.3 MULTIPOLYGON (((24472.11 29...\r\n\r\nImporting Attribute Data\r\n\r\n\r\npopdata <- read_csv(\"Data/Aspatial/respopagesextod2011to2020.csv\")\r\n\r\n\r\n\r\nData Preparation\r\nTo prepare the thematic mapd, the following data table with year 2020 values is prepared.\r\nYOUNG: age group 0 to 4 until age groyup 20 to 24,\r\nECONOMY ACTIVE: age group 25-29 until age group 60-64,\r\nAGED: age group 65 and above,\r\nTOTAL: all age group, and\r\nDEPENDENCY: the ratio between young and aged against economy active group\r\nData Wrangling\r\nThe following data wrangling and transformation functions will be used:\r\npivot_wider() of tidyr package, and\r\nmutate(), filter(), group_by() and select() of dplyr package\r\n\r\n\r\npopdata2020 <- popdata %>%\r\n  filter(Time == 2020) %>%\r\n  group_by(PA, SZ, AG) %>%\r\n  summarise(`POP` = sum(`Pop`)) %>%\r\n  ungroup()%>%\r\n  pivot_wider(names_from=AG, \r\n              values_from=POP) %>%\r\n  mutate(YOUNG = rowSums(.[3:6])\r\n         +rowSums(.[12])) %>%\r\nmutate(`ECONOMY ACTIVE` = rowSums(.[7:11])+\r\nrowSums(.[13:15]))%>%\r\nmutate(`AGED`=rowSums(.[16:21])) %>%\r\nmutate(`TOTAL`=rowSums(.[3:21])) %>%  \r\nmutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\r\n/`ECONOMY ACTIVE`) %>%\r\n  select(`PA`, `SZ`, `YOUNG`, \r\n       `ECONOMY ACTIVE`, `AGED`, \r\n       `TOTAL`, `DEPENDENCY`)\r\n\r\n\r\n\r\nCombining the Attribute and Geospatial Data (Georelational Data)\r\nThis code chunk convert the values in PA and SZ fields to uppercase to match with the data in the SUBZONE_N and PLN_AREA_N\r\n\r\n\r\npopdata2020 <- popdata2020 %>%\r\n  mutate_at(.vars = vars(PA, SZ), \r\n          .funs = funs(toupper)) %>%\r\n  filter(`ECONOMY ACTIVE` > 0)\r\n\r\n\r\n\r\nleft_join() of dplyr is used to join the geographical data and attribute table using planning subzone name e.g. SUBZONE_N and SZ as the common identifier. mpsz simple feature data frame is used as the left data table to ensure that the output will be a simple features data frame.\r\n\r\n\r\nmpsz_pop2020 <- left_join(mpsz, popdata2020,\r\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\r\n\r\n\r\n\r\nChoropleth Mapping Geospatial Data Using tmap\r\nThe following two approaches are explored to prepare thematic map using tmap:\r\nPlotting a thematic map quickly by using qtm().\r\nPlotting highly customisable thematic map by using tmap elements\r\nPlotting a choropleth map quickly by using qtm()\r\nThis method is concise and provides a good default visualisation in many cases. The code chunk below will draw a cartographic standard choropleth map as shown below.\r\ntmap_mode() with “plot” option is used to produce a static map. For interactive mode, “view” option should be used.\r\nfill argument is used to map the attribute (i.e. DEPENDENCY)\r\n\r\n\r\ntmap_mode(\"plot\")\r\nqtm(mpsz_pop2020, \r\n    fill = \"DEPENDENCY\")\r\n\r\n\r\n\r\n\r\nCreating a choropleth map by using tmap’s elements\r\nThe disadvantge of qtm() is that it makes aesthetics of individual layers harder to control. To draw a high quality cartographic choropleth map as shown in the figure below, tmap’s drawing elements should be used\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"quantile\", \r\n          palette = \"Blues\",\r\n          title = \"Dependency ratio\") +\r\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone\",\r\n            main.title.position = \"center\",\r\n            main.title.size = 1.2,\r\n            legend.height = 0.45, \r\n            legend.width = 0.35,\r\n            frame = TRUE) +\r\n  tm_borders(alpha = 0.5) +\r\n  tm_compass(type=\"8star\", size = 2) +\r\n  tm_scale_bar() +\r\n  tm_grid(alpha =0.2) +\r\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \r\n             position = c(\"left\", \"bottom\"))\r\n\r\n\r\n\r\n\r\nThe following steps show how the tmap functions that used to plot these elements\r\nStep 1: Drawing a Base Map\r\nThe basic building block of tmap is tm_shape() followed by one or more layer elemments such as tm_fill() and tm_polygons(). In the code chunk below, tm_shape() is used to define the input data (i.e mpsz_pop2020) and tm_polygons() is used to draw the planning subzone polygons\r\n\r\n\r\ntm_shape(mpsz_pop2020) +\r\n  tm_polygons()\r\n\r\n\r\n\r\n\r\nStep 2: Drawing a Choropleth Map using tm_polygon ()\r\nTo draw a choropleth map showing the geographical distribution of a selected variable by planning subzone, we just need to assign the target variable such as Dependency to tm_polygons().\r\nDefault interval binning used is called “Pretty”\r\nDefault colour scheme used is YlOrRd of ColorBrewer\r\nBy default, missing values are shaded in grey\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_polygons(\"DEPENDENCY\")\r\n\r\n\r\n\r\n\r\nStep 3: Drawing a choropleth map using tm_fill() and tm_border()\r\ntm_polygons() is a wraper of tm_fill() and tm_border(). tm_fill() shades the polygons by using the default colour scheme and tm_borders() adds the borders of the shapefile onto the choropleth map.\r\nThe code chunk below draws a choropleth map by using tm_fill() alone.\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\")\r\n\r\n\r\n\r\n\r\nTo add the boundary of the planning subzones, tm_borders will be used.\r\nalpha argument is used to define transparency number between 0 (totally transparent) and 1 (not transparent). By default, the alpha value of the col is used (normally 1)\r\ncol = border colour\r\nlwd = border line width. The default is 1\r\nlty = border line type. The default is “solid”\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\") +\r\n  tm_borders(lwd = 0.1,  alpha = 1)\r\n\r\n\r\n\r\n\r\nData classification methods of tmap\r\nThe point of classification is to take a large number of observations and group them into data ranges or classes. tmap provides a total ten data classification methods, namely: fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks.\r\nTo define a data classification method, the style argument of tm_fill() or tm_polygons() will be used.\r\nType 1: Quantile Data Classification\r\nThe code chunk below shows a quantile data classification that used 5 classes\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 5,\r\n          style = \"jenks\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nType 2: Equal Data Classification\r\nNote: The distribution of quantile data classification method are more evenly distributed then equal data classification method\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 5,\r\n          style = \"equal\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nType 3: Custome Break Data Classification\r\nFor all the built-in styles, the category breaks are computed internally. In order to override these defaults, the breakpoints can be set explicitly by means of the breaks argument to the tm_fill(). It is important to note that, in tmap the breaks include a minimum and maximum. As a result, in order to end up with n categories, n+1 elements must be specified in the breaks option (the values must be in increasing order)\r\nCode chunk below will be used to compute and display the descriptive statistics of DEPENDENCY field in order to set the break points\r\n\r\n\r\nsummary(mpsz_pop2020$DEPENDENCY)\r\n\r\n\r\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \r\n 0.0000  0.6519  0.7025  0.7742  0.7645 19.0000      92 \r\n\r\nBased on the above results, breaks vector can be classified as c(0, 0.60, 0.70, 0.80, 0.90, 1.00)\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          breaks = c(0, 0.60, 0.70, 0.80, 0.90, 1.00)) +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nColour Scheme\r\ntmap supports colour ramps either defined by the user or a set of predefined colour ramps from the RColorBrewer package\r\nUsing COLOURBREWER Palatte\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 6,\r\n          style = \"quantile\",\r\n          palette = \"Blues\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nTo reverse the colour shading, add a “-” prefix.\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\",\r\n          n = 6,\r\n          style = \"quantile\",\r\n          palette = \"-Greens\") +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nMap Layouts\r\nIn tmap, several legend options are provided to change the placement, format and appearance of the legend.\r\nMap Legend\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"jenks\", \r\n          palette = \"Blues\", \r\n          legend.hist = TRUE, \r\n          legend.is.portrait = TRUE,\r\n          legend.hist.z = 0.1) +\r\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone \\n(Jenks classification)\",\r\n            main.title.position = \"center\",\r\n            main.title.size = 1,\r\n            legend.height = 0.45, \r\n            legend.width = 0.35,\r\n            legend.outside = FALSE,\r\n            legend.position = c(\"right\", \"bottom\"),\r\n            frame = FALSE) +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nMap Style\r\ntmap allows a wide variety of layout settings to be changed. They can be called by using tmap_style().\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"quantile\", \r\n          palette = \"-Greens\") +\r\n  tm_borders(alpha = 0.5) +\r\n  tmap_style(\"classic\")\r\n\r\n\r\n\r\n\r\nCartographic Furniture\r\nBeside map style, tmap also also provides arguments to draw other map furniture such as compass, scale bar and grid lines. In the code chunk below, tm_compass(), tm_scale_bar() and tm_grid() are used to add compass, scale bar and grid lines onto the choropleth map\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"quantile\", \r\n          palette = \"Blues\",\r\n          title = \"No. of persons\") +\r\n  tm_layout(main.title = \"Distribution of Dependency Ratio \\nby planning subzone\",\r\n            main.title.position = \"center\",\r\n            main.title.size = 1.2,\r\n            legend.height = 0.45, \r\n            legend.width = 0.35,\r\n            frame = TRUE) +\r\n  tm_borders(alpha = 0.5) +\r\n  tm_compass(type=\"8star\", size = 2) +\r\n  tm_scale_bar(width = 0.15) +\r\n  tm_grid(lwd = 0.1, alpha = 0.2) +\r\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \r\n             position = c(\"left\", \"bottom\"))\r\n\r\n\r\n\r\n\r\nDrawing Small Multiple Choropleth Maps\r\nSmall multiple maps, also referred to as facet maps, are composed of many maps arrange side-by-side, and sometimes stacked vertically. Small multiple maps enable the visualisation of how spatial relationships change with respect to another variable, such as time.\r\nIn tmap, small multiple maps can be plotted in three ways:\r\nby assigning multiple values to at least one of the asthetic arguments\r\nby defining a group-by variable in tm_facets()\r\nby creating multiple stand-alone maps with tmap_arrange()\r\nBy assigning multiple values to at least one of the asthetic arguments\r\nSmall multiple choropleth maps are created by defining ncols in tm_fill()\r\n\r\n\r\ntm_shape(mpsz_pop2020)+\r\n  tm_fill(c(\"YOUNG\", \"AGED\"),\r\n          style = \"equal\", \r\n          palette = \"Blues\") +\r\n  tm_layout(legend.position = c(\"right\", \"bottom\")) +\r\n  tm_borders(alpha = 0.5) +\r\n  tmap_style(\"white\")\r\n\r\n\r\n\r\n\r\nSmall multiple choropleth maps are created by assigning multiple values to at least one of the aesthetic arguments\r\n\r\n\r\ntm_shape(mpsz_pop2020)+ \r\n  tm_polygons(c(\"DEPENDENCY\",\"AGED\"),\r\n          style = c(\"equal\", \"quantile\"), \r\n          palette = list(\"Blues\",\"Greens\")) +\r\n  tm_layout(legend.position = c(\"right\", \"bottom\"))\r\n\r\n\r\n\r\n\r\nBy defining a group-by variable in tm_facets()\r\nIn this example, multiple small choropleth maps are created by using tm_facets()\r\n\r\n\r\ntm_shape(mpsz_pop2020) +\r\n  tm_fill(\"DEPENDENCY\",\r\n          style = \"quantile\",\r\n          palette = \"Blues\",\r\n          thres.poly = 0) + \r\n  tm_facets(by=\"REGION_N\", \r\n            free.coords=TRUE, \r\n            drop.shapes=TRUE) +\r\n  tm_layout(legend.show = FALSE,\r\n            title.position = c(\"center\", \"center\"), \r\n            title.size = 20) +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nBy creating multiple stand-alone maps with tmap_arrange()\r\nIn this example, multiple small choropleth maps are created by creating multiple stand-alone maps with tmap_arrange().\r\n\r\n\r\nyoungmap <- tm_shape(mpsz_pop2020)+ \r\n  tm_polygons(\"YOUNG\", \r\n              style = \"quantile\", \r\n              palette = \"Blues\")\r\n\r\nagedmap <- tm_shape(mpsz_pop2020)+ \r\n  tm_polygons(\"AGED\", \r\n              style = \"quantile\", \r\n              palette = \"Blues\")\r\n\r\ntmap_arrange(youngmap, agedmap, asp=1, ncol=2)\r\n\r\n\r\n\r\n\r\nMappping Spatial Object Meeting a Selection Criterion\r\nInstead of creating small multiple choropleth map, you can also use selection funtion to map spatial objects meeting the selection criterion\r\n\r\n\r\ntm_shape(mpsz_pop2020[mpsz_pop2020$REGION_N==\"CENTRAL REGION\", ])+\r\n  tm_fill(\"DEPENDENCY\", \r\n          style = \"quantile\", \r\n          palette = \"Blues\", \r\n          legend.hist = TRUE, \r\n          legend.is.portrait = TRUE,\r\n          legend.hist.z = 0.1) +\r\n  tm_layout(legend.outside = TRUE,\r\n            legend.height = 0.45, \r\n            legend.width = 5.0,\r\n            legend.position = c(\"right\", \"bottom\"),\r\n            frame = FALSE) +\r\n  tm_borders(alpha = 0.5)\r\n\r\n\r\n\r\n\r\nThe End\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-08-31-hands-on-exercise-3/distill-preview.png",
    "last_modified": "2021-08-31T08:08:23+08:00",
    "input_file": "hands-on-exercise-3.knit.md"
  },
  {
    "path": "posts/2021-08-23-in-class-exercise-2/",
    "title": "In-class Exercise 2",
    "description": "In this hands-on exercise, I will learn how to handle geospatial data in R by using sf package!",
    "author": [
      {
        "name": "Niharika Avula",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-08-23",
    "categories": [],
    "contents": "\r\nGetting Started\r\nThis code chunk performs three tasks: - create a list of R packages needed\r\n\r\n\r\npackages <- c('sf', 'tidyverse')\r\nfor (p in packages){\r\n  if (!require(p, character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p, character.only = T)\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-08-31T06:01:40+08:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to IS415 blog",
    "description": "Welcome to our new blog, IS415 blog. We hope you enjoy \nreading what we have to say!",
    "author": [
      {
        "name": "Niharika Avula",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-08-23",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-08-23T09:36:16+08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-08-23-in-class-exercise-3/",
    "title": "In-class Exercise 3",
    "description": "In this hands-on exercise, I will learn how to plot Percentile, Box, Rate maps by using an R package called tmap package.",
    "author": [
      {
        "name": "Niharika Avula",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-08-23",
    "categories": [],
    "contents": "\r\n\r\n\r\npackages <- c('tmap', 'sf', 'tidyverse')\r\nfor (p in packages){\r\n  if (!require(p, character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p, character.only = T)\r\n  }\r\n\r\n\r\n\r\nThe Data\r\nTwo data set will be used to create the choropleth map. They are:\r\nMaster Plan 2014 Subzone Boundary (Web) (i.e. MP14_SUBZONE_WEB_PL) in ESRI shapefile format. It consists of the geographical boundary of Singapore at the planning subzone level. The data is based on URA Master Plan 2014.\r\nSingapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2011-2020 in csv format (i.e. respopagesextod2011to2020.csv). This is an aspatial data fie. Although it does not contain any coordinates values, but it’s PA and SZ fields can be used as unique identifiers to geocode to MP14_SUBZONE_WEB_PL shapefile.\r\nImporting Data\r\nImporting Geospatial Data\r\nThe code chunk below uses the st_read() function of sf package to import\r\n\r\n\r\nmpsz <- st_read(dsn = \"Data/Geospatial\",\r\n                layer = \"MP14_SUBZONE_WEB_PL\")\r\n\r\n\r\nReading layer `MP14_SUBZONE_WEB_PL' from data source \r\n  `C:\\Niharika-avula\\IS415_blog\\_posts\\2021-08-23-in-class-exercise-3\\Data\\Geospatial' \r\n  using driver `ESRI Shapefile'\r\nSimple feature collection with 323 features and 15 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\r\nProjected CRS: SVY21\r\n\r\n\r\n\r\nmpsz\r\n\r\n\r\nSimple feature collection with 323 features and 15 fields\r\nGeometry type: MULTIPOLYGON\r\nDimension:     XY\r\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\r\nProjected CRS: SVY21\r\nFirst 10 features:\r\n   OBJECTID SUBZONE_NO       SUBZONE_N SUBZONE_C CA_IND\r\n1         1          1    MARINA SOUTH    MSSZ01      Y\r\n2         2          1    PEARL'S HILL    OTSZ01      Y\r\n3         3          3       BOAT QUAY    SRSZ03      Y\r\n4         4          8  HENDERSON HILL    BMSZ08      N\r\n5         5          3         REDHILL    BMSZ03      N\r\n6         6          7  ALEXANDRA HILL    BMSZ07      N\r\n7         7          9   BUKIT HO SWEE    BMSZ09      N\r\n8         8          2     CLARKE QUAY    SRSZ02      Y\r\n9         9         13 PASIR PANJANG 1    QTSZ13      N\r\n10       10          7       QUEENSWAY    QTSZ07      N\r\n        PLN_AREA_N PLN_AREA_C       REGION_N REGION_C\r\n1     MARINA SOUTH         MS CENTRAL REGION       CR\r\n2           OUTRAM         OT CENTRAL REGION       CR\r\n3  SINGAPORE RIVER         SR CENTRAL REGION       CR\r\n4      BUKIT MERAH         BM CENTRAL REGION       CR\r\n5      BUKIT MERAH         BM CENTRAL REGION       CR\r\n6      BUKIT MERAH         BM CENTRAL REGION       CR\r\n7      BUKIT MERAH         BM CENTRAL REGION       CR\r\n8  SINGAPORE RIVER         SR CENTRAL REGION       CR\r\n9       QUEENSTOWN         QT CENTRAL REGION       CR\r\n10      QUEENSTOWN         QT CENTRAL REGION       CR\r\n            INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\r\n1  5ED7EB253F99252E 2014-12-05 31595.84 29220.19   5267.381\r\n2  8C7149B9EB32EEFC 2014-12-05 28679.06 29782.05   3506.107\r\n3  C35FEFF02B13E0E5 2014-12-05 29654.96 29974.66   1740.926\r\n4  3775D82C5DDBEFBD 2014-12-05 26782.83 29933.77   3313.625\r\n5  85D9ABEF0A40678F 2014-12-05 26201.96 30005.70   2825.594\r\n6  9D286521EF5E3B59 2014-12-05 25358.82 29991.38   4428.913\r\n7  7839A8577144EFE2 2014-12-05 27680.06 30230.86   3275.312\r\n8  48661DC0FBA09F7A 2014-12-05 29253.21 30222.86   2208.619\r\n9  1F721290C421BFAB 2014-12-05 22077.34 29893.78   6571.323\r\n10 3580D2AFFBEE914C 2014-12-05 24168.31 30104.18   3454.239\r\n   SHAPE_Area                       geometry\r\n1   1630379.3 MULTIPOLYGON (((31495.56 30...\r\n2    559816.2 MULTIPOLYGON (((29092.28 30...\r\n3    160807.5 MULTIPOLYGON (((29932.33 29...\r\n4    595428.9 MULTIPOLYGON (((27131.28 30...\r\n5    387429.4 MULTIPOLYGON (((26451.03 30...\r\n6   1030378.8 MULTIPOLYGON (((25899.7 297...\r\n7    551732.0 MULTIPOLYGON (((27746.95 30...\r\n8    290184.7 MULTIPOLYGON (((29351.26 29...\r\n9   1084792.3 MULTIPOLYGON (((20996.49 30...\r\n10   631644.3 MULTIPOLYGON (((24472.11 29...\r\n\r\nImporting Attribute Data\r\n\r\n\r\npopdata <- read_csv(\"Data/Aspatial/respopagesextod2011to2020.csv\")\r\n\r\n\r\n\r\nData Preparation\r\nTo prepare the thematic mapd, the following data table with year 2020 values is prepared.\r\nYOUNG: age group 0 to 4 until age groyup 20 to 24,\r\nECONOMY ACTIVE: age group 25-29 until age group 60-64,\r\nAGED: age group 65 and above,\r\nTOTAL: all age group, and\r\nDEPENDENCY: the ratio between young and aged against economy active group\r\nData Wrangling\r\nThe following data wrangling and transformation functions will be used:\r\npivot_wider() of tidyr package, and\r\nmutate(), filter(), group_by() and select() of dplyr package\r\n\r\n\r\npopdata2020 <- popdata %>%\r\n  filter(Time == 2020) %>%\r\n  group_by(PA, SZ, AG) %>%\r\n  summarise(`POP` = sum(`Pop`)) %>%\r\n  ungroup()%>%\r\n  pivot_wider(names_from=AG, \r\n              values_from=POP) %>%\r\n  mutate(YOUNG = rowSums(.[3:6])\r\n         +rowSums(.[12])) %>%\r\nmutate(`ECONOMY ACTIVE` = rowSums(.[7:11])+\r\nrowSums(.[13:15]))%>%\r\nmutate(`AGED`=rowSums(.[16:21])) %>%\r\nmutate(`TOTAL`=rowSums(.[3:21])) %>%  \r\nmutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\r\n/`ECONOMY ACTIVE`) %>%\r\n  select(`PA`, `SZ`, `YOUNG`, \r\n       `ECONOMY ACTIVE`, `AGED`, \r\n       `TOTAL`, `DEPENDENCY`)\r\n\r\n\r\n\r\nCombining the Attribute and Geospatial Data (Georelational Data)\r\nThis code chunk convert the values in PA and SZ fields to uppercase to match with the data in the SUBZONE_N and PLN_AREA_N\r\n\r\n\r\npopdata2020 <- popdata2020 %>%\r\n  mutate_at(.vars = vars(PA, SZ), \r\n          .funs = funs(toupper)) %>%\r\n  filter(`ECONOMY ACTIVE` > 0)\r\n\r\n\r\n\r\nleft_join() of dplyr is used to join the geographical data and attribute table using planning subzone name e.g. SUBZONE_N and SZ as the common identifier. mpsz simple feature data frame is used as the left data table to ensure that the output will be a simple features data frame.\r\n\r\n\r\nmpsz_pop2020 <- left_join(mpsz, popdata2020,\r\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\r\n\r\n\r\n\r\nData Visualisation\r\nBoxplot - Visualising Extreme Values\r\nBoxplot is one one the popular Exploratory Data Analysis (EDA) technique used to show the statistics and distribution of data values\r\n\r\n\r\nggplot(data=mpsz_pop2020, \r\n       aes(x = \"\", \r\n           y = AGED)) +\r\n  geom_boxplot()\r\n\r\n\r\n\r\n\r\nDespite its usefulness, boxplot is not able to reveal the spatial distribution of these outliers.\r\nPercentile Map\r\nSpecial type of quantile map with six specific categories: 0-1%,1-10%, 10-50%,50-90%,90-99%, and 99-100%.\r\nThe corresponding breakpoints can be derived by means of the base R quantile command, passing an explicit vector of cumulative probabilities as c(0,.01,.1,.5,.9,.99,1)\r\n\r\nThis code chunk excludes records with NA\r\n\r\n\r\nmpsz_pop2020a <- mpsz_pop2020 %>%\r\n  drop_na()\r\n\r\n\r\n\r\n\r\n\r\npercent <- c(0,.01,.1,.5,.9,.99,1)\r\nvar <- mpsz_pop2020a[\"DEPENDENCY\"] %>%\r\n  st_set_geometry(NULL)\r\nquantile(var[,1], percent)\r\n\r\n\r\n        0%         1%        10%        50%        90%        99% \r\n 0.0000000  0.1377778  0.5686120  0.7024793  0.8474114  1.2100000 \r\n      100% \r\n19.0000000 \r\n\r\nThe code chunk below is an R function to extract a variable as a vector out of an sf data frame\r\nArguments: vname: variable name (as character, in quotes); df: name of sf data frame\r\nreturns: v: vector with values (without a column name)\r\n\r\n\r\nget.var <- function(vname,df) {\r\n  v <- df[vname] %>% \r\n    st_set_geometry(NULL)\r\n  v <- unname(v[,1])\r\n  return(v)\r\n}\r\n\r\n\r\n\r\n\r\n\r\npercent <- c(0,.01,.1,.5,.9,.99,1)\r\nvar <- get.var(\"DEPENDENCY\", mpsz_pop2020a)\r\nbperc <- quantile(var,percent)\r\ntm_shape(mpsz_pop2020) +\r\n  tm_polygons() +\r\ntm_shape(mpsz_pop2020a) +\r\n  tm_fill(\"DEPENDENCY\",\r\n          title=\"DEPENDENCY\",\r\n          breaks=bperc,\r\n          palette=\"Blues\",\r\n          labels=c(\"< 1%\", \"1% - 10%\",\r\n                   \"10% - 50%\", \r\n                   \"50% - 90%\",\r\n                   \"90% - 99%\", \r\n                   \"> 99%\"))  +\r\n  tm_borders() +\r\n  tm_layout(title = \"Percentile Map\", \r\n            title.position = c(\"right\",\r\n                               \"bottom\"))\r\n\r\n\r\n\r\n\r\nPercentile Mapping Function\r\n\r\n\r\npercentmap <- function(vnam, df, legtitle=NA, mtitle=\"Percentile Map\"){\r\n  percent <- c(0,.01,.1,.5,.9,.99,1)\r\n  var <- get.var(vnam,df)\r\n  bperc <- quantile(var,percent)\r\n  tm_shape(mpsz_pop2020) +\r\n  tm_polygons() +\r\n  tm_shape(df) +\r\n     tm_fill(vnam,\r\n             title=legtitle,\r\n             breaks=bperc,\r\n             palette=\"Blues\",\r\n          labels=c(\"< 1%\", \"1% - 10%\", \"10% - 50%\", \"50% - 90%\", \"90% - 99%\", \"> 99%\"))  +\r\n  tm_borders() +\r\n  tm_layout(title = mtitle, title.position = c(\"right\",\"bottom\"))\r\n}\r\n\r\n\r\n\r\n\r\n\r\nyoungmap <- percentmap(\"YOUNG\", mpsz_pop2020a)\r\nagedmap <- percentmap(\"AGED\", mpsz_pop2020a)\r\n\r\n\r\n\r\nBox Map\r\nDisplaying summary statistics on a choropleth map by using the basic principles of boxplot\r\nTo create a box map, a custom breaks specification will be used. However, the break points for the box map vary depending on whether lower or upper outliers are present.\r\nThe code chunk below is an R function that creates break points for a box map.\r\nArguments: * v: vector with observations * mult: multiplier for IQR (default 1.5) Returns: * bb: vector with 7 break points compute quartile and fences\r\n\r\n\r\nboxbreaks <- function(v,mult=1.5) {\r\n  qv <- unname(quantile(v))\r\n  iqr <- qv[4] - qv[2]\r\n  upfence <- qv[4] + mult * iqr\r\n  lofence <- qv[2] - mult * iqr\r\n  # initialize break points vector\r\n  bb <- vector(mode=\"numeric\",length=7)\r\n  # logic for lower and upper fences\r\n  if (lofence < qv[1]) {  # no lower outliers\r\n    bb[1] <- lofence\r\n    bb[2] <- floor(qv[1])\r\n  } else {\r\n    bb[2] <- lofence\r\n    bb[1] <- qv[1]\r\n  }\r\n  if (upfence > qv[5]) { # no upper outliers\r\n    bb[7] <- upfence\r\n    bb[6] <- ceiling(qv[5])\r\n  } else {\r\n    bb[6] <- upfence\r\n    bb[7] <- qv[5]\r\n  }\r\n  bb[3:5] <- qv[2:4]\r\n  return(bb)\r\n}\r\n\r\n\r\n\r\n\r\n\r\nget.var <- function(vname,df) {\r\n  v <- df[vname] %>% st_set_geometry(NULL)\r\n  v <- unname(v[,1])\r\n  return(v)\r\n}\r\n\r\n\r\n\r\n\r\n\r\nvar <- get.var(\"AGED\", mpsz_pop2020a) \r\nboxbreaks(var)\r\n\r\n\r\n[1] -4330     0   515  2080  3745  8590 20240\r\n\r\nThe code chunk below is an R function to create a box map.\r\nArguments: * vnam: variable name (as character, in quotes) * df: simple features polygon layer * legtitle: legend title * mtitle: map title * mult: multiplier for IQR\r\nReturns: * a tmap-element (plots a map)\r\n\r\n\r\nboxmap <- function(vnam, df, \r\n                   legtitle=NA,\r\n                   mtitle=\"Box Map\",\r\n                   mult=1.5){\r\n  var <- get.var(vnam,df)\r\n  bb <- boxbreaks(var)\r\n  tm_shape(df) +\r\n     tm_fill(vnam,title=legtitle,\r\n             breaks=bb,\r\n             palette=\"Blues\",\r\n          labels = c(\"lower outlier\", \r\n                     \"< 25%\", \r\n                     \"25% - 50%\", \r\n                     \"50% - 75%\",\r\n                     \"> 75%\", \r\n                     \"upper outlier\"))  +\r\n  tm_borders() +\r\n  tm_layout(title = mtitle, \r\n            title.position = c(\"right\",\r\n                               \"bottom\"))\r\n}\r\n\r\n\r\n\r\nPlotting the box map\r\n\r\n\r\nboxmap(\"ECONOMY ACTIVE\", mpsz_pop2020a)\r\n\r\n\r\n\r\n\r\nThe box map reveals that there are six upper outliers (i.e. planning subzone with extremely high numbers of aged population). Four of the upper outliers are located at the eastern region and they are closed to each others and there is no lower outlier.\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-08-23-in-class-exercise-3/in-class-exercise-3_files/figure-html5/unnamed-chunk-8-1.png",
    "last_modified": "2021-09-01T08:44:07+08:00",
    "input_file": "in-class-exercise-3.knit.md"
  }
]
